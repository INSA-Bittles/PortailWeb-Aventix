<!DOCTYPE html>
<html ng-app="userApp">
          
    <% include includes/header.ejs %>
          
            <style>
              #drop{
               border:2px dashed black;
                  -moz-border-radius:5px;
                  -webkit-border-radius:5px;
                  border-radius:5px;
                  padding:25px;
                  text-align:center;
                  font:20pt bold,"Vollkorn";color:black
              }
              #b64data{
                width:100%;
              }
          </style>

<body>
<div class="container">
  <div class="page-header text-center">
    <p>
      <strong>Nom d'utilisateur</strong> : <%= user.username %><br>
      <strong>Identifiant</strong> : <%= user.idDecideur %><br>
      <strong>Nom de la société :</strong> : <%= user.Decideur.NomSociete %><br>
      <strong>Nom</strong> : <%= user.Decideur.nom %><br>
      <strong>Prénom</strong> : <%= user.Decideur.prenom %><br>
      <strong>Adresse</strong> : <%= user.Decideur.adresse %>&nbsp;<%= user.Decideur.cp %>&nbsp;<%= user.Decideur.ville %><br>
      <strong>Email</strong> : <%= user.Decideur.email %><br>
    </p>
  </div>
    
<h1><span class="fa fa-sign-in"></span> Créer des cartes :</h1>

  <div class=".col-xs-6 .col-md-4" ng-controller="carteCtrl">
      <h3 id="souscription_benef">Souscrire de nouveaux béneficiaires</h3>
      <form style="margin-bottom:10px;" name="carteForm" ng-submit="pushCarte()" novalidate>
        <div class="form-group">
            <!-- <label><h4>Sélectionner le nombre de cartes</h4></label>
            <input type="text" class="form-control" ng-model="nombreCarte" name="nombreCarte" required="name"><span ng-show="carteForm.nombreCarte.$error.required">Ce champ doit être renseigné.</span><br> -->
            <label><h4>Taper le solde pour le nouveau bénéficiaire :</h4></label> 
            <input type="text" class="form-control" ng-model="solde" name="solde" required="name"><span ng-show="carteForm.solde.$error.required">Ce champ doit être renseigné.</span><br><br> 
            <button type="submit" class="btn btn-info btn-lg" ng-disabled="carteForm.$invalid" ng-click="successAlert()" >Créer une carte</button><br><br>
            <flash-message duration="10000" show-close="true" on-dismiss="myCallback(flash)" ></flash-message>
        </div>
      </form><button class="btn btn-info btn-lg" name="answer" value="Show Div" onclick="showDiv()">Obtenir numéro de la carte ajoutée :<div  id="numeroCarteDiv" style="display:none;" ng-repeat="carte in cartes">{{carte.max}}</div></button>
  </div> 
<div ng-controller="pushCtrl">
<div class=".col-xs-12 .col-md-8" ><h1>Liste des Bénéficiaires :</h1>
  <form class="form-inline">
        <div class="form-group">
            <label >Rechercher</label>
            <input type="text" ng-model="search" class="form-control" placeholder="Search">
        </div>
    </form>
  <table style="width:100%">
    <tr>   
      <td style="vertical-align: top">
            <table class="table" >
              <tr>
                <th ng-click="sort('idBeneficiaire')">Id&nbsp;<span class="glyphicon sort-icon" ng-show="sortKey=='idBeneficiaire'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                </th>
                <th ng-click="sort('nom')">Nom du béneficiaire<span class="glyphicon sort-icon" ng-show="sortKey=='nom'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                </th>
                <th ng-click="sort('prenom')">Prenom du béneficiaire<span class="glyphicon sort-icon" ng-show="sortKey=='prenom'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                </th>
                <th ng-click="sort('adresse')">Adresse du béneficiaire<span class="glyphicon sort-icon" ng-show="sortKey=='adresse'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                </th>
                <th ng-click="sort('cp')">Code Postal du béneficiaire<span class="glyphicon sort-icon" ng-show="sortKey=='cp'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                </th>
                <th ng-click="sort('ville')">Ville du béneficiaire<span class="glyphicon sort-icon" ng-show="sortKey=='ville'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                </th>
                <th ng-click="sort('email')">Adresse Mail du béneficiaire<span class="glyphicon sort-icon" ng-show="sortKey=='email'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                </th>
                <th ng-click="sort('Status')">Status du béneficiaire<span class="glyphicon sort-icon" ng-show="sortKey=='Status'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                </th>
                <th ng-click="sort('NumeroCarte')">Numéro de carte du béneficiaire<span class="glyphicon sort-icon" ng-show="sortKey=='NumeroCarte'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                </th>
                <th ng-click="sort('IdDecideur')">ID Decideur<span class="glyphicon sort-icon" ng-show="sortKey=='IdDecideur'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                </th>
                <th>Action</th>
                <th>&nbsp;</th>
                <th>&nbsp;</th>
              </tr>
              <tbody>
                <tr>
                  <td></td>
                  <td><input type="text" class="form-control" ng-model="beneficiaire.nom" name="nom" required="name"></td>
                  <td><input type="text" class="form-control" ng-model="beneficiaire.prenom" name="prenom" required="name"></td>
                  <td><input type="text" class="form-control" ng-model="beneficiaire.adresse" name="adresse" required="name"></td>
                  <td><input type="text" class="form-control" ng-model="beneficiaire.cp" name="cp" required="name"></td>
                  <td><input type="text" class="form-control" ng-model="beneficiaire.ville" name="ville" required="name"></td>
                  <td><input type="text" class="form-control" ng-model="beneficiaire.email" name="email" required="email"></td>
                  <td><input type="text" class="form-control" ng-model="beneficiaire.Status" name="Status" required="name"></td>
                  <td><input type="text" class="form-control" ng-model="beneficiaire.NumeroCarte" name="NumeroCarte" required="name"></td>
                  <td><input type="text" class="form-control" ng-model="beneficiaire.IdDecideur" name="idDecideur" required="name"></td>
                  <td><button type="submit" class="btn btn-primary btn-lg" ng-disabled="benefForm.$invalid" ng-click="pushData(); successAlert2()">Ajouter un bénéficiaire</button><br>
                </td>
                <td><button type="submit" class="btn btn-info btn-lg"  ng-click="update(); successAlert4()">Update</button></td>
                <td><button type="submit" class="btn btn-info btn-lg"  ng-click="deselect()">Effacer</button></td>
                
                </tr>
              <tr dir-paginate="beneficiaire in beneficiaires | orderBy:sortKey:reverse|filter:search|itemsPerPage:5">
                <td>{{beneficiaire.idBeneficiaire}}
                </td>
                <td>{{beneficiaire.nom}}
                </td>
                <td>{{beneficiaire.prenom}}
                </td>
                <td>{{beneficiaire.adresse}}
                </td>
                <td>{{beneficiaire.cp}}
                </td>
                <td>{{beneficiaire.ville}}
                </td>
                <td>{{beneficiaire.email}}
                </td>
                <td>{{beneficiaire.Status}}
                </td>
                <td>{{beneficiaire.NumeroCarte}}
                </td>
                <td>{{beneficiaire.IdDecideur}}
                </td>
                <td><button type="submit" class="btn btn-danger btn-lg"  ng-click="remove(beneficiaire.idBeneficiaire); successAlert5()">Supprimer</button>
                </td>
                <td><button type="submit" class="btn btn-warning btn-lg"  ng-click="edit(beneficiaire.idBeneficiaire)">Editer</button>
                </td>        
              </tr>
              </tbody>
            </table>
          </td>
        </tr>
      </table>
      <dir-pagination-controls max-size="5" direction-links="true" boundary-links="true" ></dir-pagination-controls>
    </div><flash-message duration="10000" show-close="true" on-dismiss="myCallback(flash)" ></flash-message>
    </div>

<div ng-controller="FlashCtrl">    

    <div class=".col-xs-6 .col-md-4">

      
<!-- <div ng-controller="pushCtrl">
    
    <h1><span class="fa fa-user-plus"></span> Créer un compte beneficiaire</h1>
    <form style="margin-bottom:80px;" name="beneficiaireForm" ng-submit="pushData()" novalidate>
        <div class="form-group">
            <label>Nom du Bénéficiaire</label>
            <input type="text" class="form-control" ng-model="nom" name="nom" required="name"><span ng-show="beneficiaireForm.nom.$error.required">Ce champ doit être renseigné.</span>
        </div>
        <div class="form-group">
            <label>Prénom du bénéficiaire</label>
            <input type="text" class="form-control" ng-model="prenom" name="prenom" required="name"><span ng-show="beneficiaireForm.prenom.$error.required">Ce champ doit être renseigné.</span>
        </div>
        <div class="form-group">
            <label>Adresse du bénéficiaire</label>
            <input type="text" class="form-control" ng-model="adresse"name="adresse"><span ng-show="beneficiaireForm.adresse.$error.required" required="name">Ce champ doit être renseigné.</span>
        </div>
        <div class="form-group">
            <label>Ville du Bénéficiaire</label>
            <input type="text" class="form-control" ng-model="ville" name="ville" required="name"><span ng-show="beneficiaireForm.ville.$error.required">Ce champ doit être renseigné.</span>
        </div>
        <div class="form-group">
            <label>Code postal du Bénéficiaire</label>
            <input type="text" class="form-control" ng-model="cp" name="codePostal" required="name"><span ng-show="beneficiaireForm.codePostal.$error.required">Ce champ doit être renseigné.</span>
        </div>
        <div class="form-group">
            <label>Email</label>
            <input type="email" class="form-control" ng-model="email" name="email" required="email"><span ng-show="beneficiaireForm.email.$error.required">Ce champ doit être renseigné.</span><span ng-show="beneficiaireForm.email.$error.email">Ce n'est pas un mail valide.</span>
        </div>
        <div class="form-group">
            <label>Numéro De Carte</label>
            <input type="text" class="form-control" ng-model="numero" name="numéro" required="name"><span ng-show="beneficiaireForm.numero.$error.required">Ce champ doit être renseigné.</span>
        </div>
        <div class="form-group">
            <label>ID Décideur</label>
            <input type="text" class="form-control" ng-model="idDecideur" name="idDecideur" required="name"><span ng-show="beneficiaireForm.idDecideur.$error.required">Ce champ doit être renseigné.</span>
        </div>
        <div class="form-group">
            <label>Status</label>
            <input type="text" class="form-control" ng-model="Status" name="Status" required="name"><span ng-show="beneficiaireForm.Status.$error.required">Ce champ doit être renseigné.</span>
        </div>
        <button type="submit" class="btn btn-info btn-lg" ng-disabled="beneficiaireForm.$invalid" ng-click="successAlert2()">Insérer</button><br><br>
        <flash-message duration="10000" show-close="true" on-dismiss="myCallback(flash)" ></flash-message>

    </form>
  </div>
</div> -->



    <div class=".col-xs-6 .col-md-4"  ng-controller="userCtrl">
    <h1><span class="fa fa-user-plus"></span> Créer le compte Utilisateur du bénéficiaire :</h1>
    <!-- LOGIN FORM -->
    <form style="margin-bottom:80px;" name="userForm" action="/signup" method="post" novalidate>
        <div class="form-group">
            <label>idBeneficiaire</label>
            <input type="text" class="form-control" ng-model="user.idBeneficiaire" name="idBeneficiaire" required="name"><span ng-show="userForm.idBeneficiaire.$error.required">Ce champ doit être renseigné.</span>
        </div>
        <div class="form-group">
            <label>Login</label>
            <input type="text" class="form-control" ng-model="user.username"  name="username" required="name"><span ng-show="userForm.username.$error.required">Ce champ doit être renseigné.</span>
        </div>
        <div class="form-group">
            <label>Mot de passe</label>
            <input type="password" class="form-control" ng-model="user.password" name="password" required="password"><span ng-show="userForm.password.$error.required">Ce champ doit être renseigné.</span>
        </div>
        <button type="submit" ng-disabled="userForm.$invalid" class="btn btn-info btn-lg">Créer</button>&nbsp;&nbsp;&nbsp;<button type="submit" class="btn btn-danger btn-lg"  ng-click="removeUser(user.idBeneficiaire); successAlert8()">Supprimer le compte</button>
    </form>
    </div>
</div>

  <div class=".col-xs-6 .col-md-4" ng-controller="soldeCtrl">
      <h1 id="update-password"><span class="glyphicon glyphicon-credit-card"></span>&nbsp;Modifier le solde d'un bénéficiaire :</h1>
      <form style="margin-bottom:80px;" name="passwordForm" ng-submit="updateSolde()" novalidate>
        <div class="form-group">
          <label><h4>Entrer le numéro de carte du bénéficiaire :</h4></label>
            <input type="text" class="form-control" ng-model="beneficiaire.NumeroCarte" name="NumeroCarte" required="name"><span ng-show="passwordForm.NumeroCarte.$error.required">Ce champ doit être renseigné.</span><br>
            <label><h4>Nouveau solde :</h4></label>
            <input type="text" class="form-control" ng-model="beneficiaire.solde" name="solde" required="name"><span ng-show="passwordForm.solde.$error.required">Ce champ doit être renseigné.</span><br><br>
            <button type="submit" class="btn btn-info btn-lg" ng-disabled="passwordForm.$invalid" ng-click="successAlert6()">Valider</button>&nbsp;&nbsp;&nbsp;<button type="submit" class="btn btn-info btn-lg"  ng-click="deselect2()">Effacer</button>&nbsp;&nbsp;&nbsp;<button type="submit" class="btn btn-danger btn-lg"  ng-click="removeCarte(beneficiaire.NumeroCarte); successAlert7()">Supprimer Carte</button><br><br>
            <flash-message duration="10" show-close="true" on-dismiss="myCallback(flash)" ></flash-message>
        </div>
      </form>
  </div>




<div class=".col-xs-6 .col-md-4" ng-controller="passwordCtrl">
      <h1 id="update-password"><i class="fa fa-unlock"></i>&nbsp;Modifier votre mot de passe :</h1>
      <form style="margin-bottom:80px;" name="passwordForm" ng-submit="updatePassword2()" novalidate>
        <div class="form-group">
          <label><h4>Entrer votre ID :</h4></label>
            <input type="text" class="form-control" ng-model="user.idDecideur" name="idDecideur" required="name"><span ng-show="passwordForm.idDecideur.$error.required">Ce champ doit être renseigné.</span><br>
            <label><h4>Nouveau mot de passe :</h4></label>
            <input type="text" class="form-control" ng-model="user.mdp" name="pass" required="name"><span ng-show="passwordForm.mdp.$error.required">Ce champ doit être renseigné.</span><br>
            <label><h4>Confirmer mot de passe</h4></label> 
            <input type="password" class="form-control" ng-model="user.password" name="password" required="name"><span ng-show="passwordForm.password.$error.required">Ce champ doit être renseigné.</span><br>
            <button type="submit" class="btn btn-info btn-lg" ng-disabled="passwordForm.$invalid" ng-click="successAlert3()">Valider</button><br><br>
            <flash-message duration="10000" show-close="true" on-dismiss="myCallback(flash)" ></flash-message>
        </div>
      </form>
  </div>

      <h1><span class="fa fa-sign-in"></span> Import en masse de bénéficiaires</h1>
          </select><br />
          <p>Souscrire vos employés à l'offre Aventix n'a jamais été aussi simple! Glissez votre fichier excel ci-dessous et vos employés sont dans nos bases de données  </p>
          <div class="dropper" id="drop">Deposer un fichier Excel ici!( XLSX / XLS / XML )</div>
          <p><input type="file" name="xlfile" id="xlf" /> </p>
           <p style="float:left"> ... ou cliquer ci-dessus pour selectionner un dossier</p>

          <a href="#more_option" data-toggle="collapse">
              <img src="img/logo_aventix.png" alt="Random Name">
          </a> 
          <div id="more_option" class="collapse"> 
              Output Format:
              <select name="format">
              <option value="json" selected > JSON</option>
              Advanced Demo Options: <br />
              Use Web Workers: (when available) <input type="checkbox" name="useworker" checked><br />
              Use Transferrables: (when available) <input type="checkbox" name="xferable" checked><br />
              Use readAsBinaryString: (when available) <input type="checkbox" name="userabs" checked><br />
              <pre id="out"></pre>
            </select>
          </div>
    </div>
</div>
          <!-- les scripts utiles pour le DragAndDrop 
      ATTENTION!! ne pas les mettre au debut du document sinon les scripts s'executent avant le chargement complet de la page 
      et survient erreur car ne trouve pas l'element drop -->
      
</body>

  <% include includes/footer.ejs %>
  <script type="text/javascript">
        function showDiv() {
        document.getElementById('numeroCarteDiv').style.display = "block";
        }
      </script>
  
  <script src="js-xlsx-master/shim.js"></script>
  <script src="js-xlsx-master/jszip.js"></script>
  <script src="js-xlsx-master/xlsx.js"></script>
  <script src="js-xlsx-master/ods.js"></script>
  <script lang="javascript" src="js-xlsx-master/dist/xlsx.core.min.js"></script>
  <script src="js/DragAndDrop.js"></script>   

</html>